<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Clientes y Servicios</title>
</head>
<body>
    <h1>Gestión de Clientes y Servicios</h1>

    <!-- Formulario para Registrar Cliente -->
    <section>
        <h2>Registrar Cliente</h2>
        <form id="clienteForm">
            <label for="identificacion">Identificación:</label>
            <input type="text" id="identificacion" name="identificacion" required><br>
            
            <label for="nombres">Nombres:</label>
            <input type="text" id="nombres" name="nombres" required><br>
            
            <label for="apellidos">Apellidos:</label>
            <input type="text" id="apellidos" name="apellidos" required><br>
            
            <label for="tipoIdentificacion">Tipo de Identificación:</label>
            <select id="tipoIdentificacion" name="tipoIdentificacion" required>
                <option value="CC">Cédula de Ciudadanía (CC)</option>
                <option value="TI">Tarjeta de Identidad (TI)</option>
                <option value="CE">Cédula de Extranjería (CE)</option>
                <option value="RC">Registro Civil (RC)</option>
            </select><br>
            
            <label for="fechaNacimiento">Fecha de Nacimiento:</label>
            <input type="date" id="fechaNacimiento" name="fechaNacimiento" required><br>
            
            <label for="numeroCelular">Número de Celular:</label>
            <input type="text" id="numeroCelular" name="numeroCelular" required><br>
            
            <label for="correoElectronico">Correo Electrónico:</label>
            <input type="email" id="correoElectronico" name="correoElectronico" required><br>
            
            <button type="submit">Registrar Cliente</button>
        </form>
        <p id="clienteResult"></p>
    </section>

    <!-- Formulario para Registrar Servicio -->
    <section>
        <h2>Registrar Servicio</h2>
        <form id="servicioForm">
            <label for="identificacionServicio">Identificación del Cliente:</label>
            <input type="text" id="identificacionServicio" name="identificacionServicio" required><br>
            
            <label for="servicio">Servicio:</label>
            <select id="servicio" name="servicio" required>
                <option value="Internet 200 MB">Internet 200 MB</option>
                <option value="Internet 400 MB">Internet 400 MB</option>
                <option value="Internet 600 MB">Internet 600 MB</option>
                <option value="Directv Go">Directv Go</option>
                <option value="Paramount+">Paramount+</option>
                <option value="Win+">Win+</option>
            </select><br>
            
            <label for="fechaInicio">Fecha de Inicio:</label>
            <input type="date" id="fechaInicio" name="fechaInicio" required><br>
            
            <label for="ultimaFacturacion">Última Facturación:</label>
            <input type="date" id="ultimaFacturacion" name="ultimaFacturacion" required><br>
            
            <label for="ultimoPago">Último Pago:</label>
            <input type="number" id="ultimoPago" name="ultimoPago" required><br>
            
            <button type="submit">Registrar Servicio</button>
        </form>
        <p id="servicioResult"></p>
    </section>

    <!-- Formulario para Consultar Cliente -->
    <section>
        <h2>Consultar Cliente</h2>
        <form id="consultaForm">
            <label for="consultaIdentificacion">Identificación del Cliente:</label>
            <input type="text" id="consultaIdentificacion" name="consultaIdentificacion" required><br>
            
            <button type="submit">Consultar Cliente</button>
        </form>
        <div id="consultaResult"></div>
    </section>

    <script>
        // Registrar Cliente
        document.getElementById('clienteForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const data = {
                identificacion: document.getElementById('identificacion').value,
                nombres: document.getElementById('nombres').value,
                apellidos: document.getElementById('apellidos').value,
                tipoIdentificacion: document.getElementById('tipoIdentificacion').value,
                fechaNacimiento: document.getElementById('fechaNacimiento').value,
                numeroCelular: document.getElementById('numeroCelular').value,
                correoElectronico: document.getElementById('correoElectronico').value,
            };

            fetch('http://localhost:5000/clientes', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).then(response => response.json())
            .then(data => document.getElementById('clienteResult').textContent = data.message)
            .catch(error => console.error('Error:', error));
        });

        // Registrar Servicio
        document.getElementById('servicioForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const data = {
                identificacion: document.getElementById('identificacionServicio').value,
                servicio: document.getElementById('servicio').value,
                fechaInicio: document.getElementById('fechaInicio').value,
                ultimaFacturacion: document.getElementById('ultimaFacturacion').value,
                ultimoPago: document.getElementById('ultimoPago').value,
            };

            fetch('http://localhost:5000/servicios', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).then(response => response.json())
            .then(data => document.getElementById('servicioResult').textContent = data.message)
            .catch(error => console.error('Error:', error));
        });


        // Consultar Cliente
        document.getElementById('consultaForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const identificacion = document.getElementById('consultaIdentificacion').value;

            fetch(`http://localhost:5000/clientes/${identificacion}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(response => response.json())
              .then(data => {
                  const resultDiv = document.getElementById('consultaResult');
                  if (data.message) {
                      resultDiv.textContent = data.message;
                  } else {
                      resultDiv.innerHTML = `
                        <h3>Información del Cliente</h3>
                        <p>Nombre: ${data.nombres} ${data.apellidos}</p>
                        <p>Identificación: ${data.identificacion}</p>
                        <p>Tipo de Identificación: ${data.tipo_identificacion}</p>
                        <p>Fecha de Nacimiento: ${data.fecha_nacimiento}</p>
                        <p>Teléfono: ${data.numero_celular}</p>
                        <p>Correo: ${data.correo_electronico}</p>
                        <h4>Servicios Contratados</h4>
                        <ul>
                            ${data.servicios.map(s => `<li>${s.servicio} - Último Pago: ${s.ultimo_pago}</li>`).join('')}
                        </ul>
                      `;
                  }
              })
              .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
